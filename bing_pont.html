<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IB French B SL - D√©crire une Image BINGO</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 2px solid #ddd;
        }

        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            background: #f5f5f5;
            border: none;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s;
            color: #666;
        }

        .tab:hover {
            background: #e0e0e0;
        }

        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .image-container {
            text-align: center;
            margin-bottom: 30px;
        }

        .image-container img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .bingo-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .bingo-cell {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: white;
            font-weight: bold;
            position: relative;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .bingo-cell:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }

        .bingo-cell.center {
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            font-size: 1.2em;
        }

        .bingo-cell.completed {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .bingo-cell.completed::after {
            content: "‚úì";
            position: absolute;
            top: 5px;
            right: 10px;
            font-size: 2em;
            color: white;
        }

        .recording-indicator {
            display: none;
            background: #ff4444;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            margin: 10px auto;
            text-align: center;
            animation: pulse 1s infinite;
        }

        .recording-indicator.active {
            display: block;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            margin: -30px -30px 20px -30px;
            border-radius: 15px 15px 0 0;
        }

        .close {
            color: white;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            opacity: 0.7;
        }

        .record-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s;
        }

        .record-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .record-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .stop-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
        }

        .phrases-bank {
            margin-top: 20px;
        }

        .filter-section {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .filter-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .filter-btn {
            padding: 10px 20px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .filter-btn:hover, .filter-btn.active {
            background: #667eea;
            color: white;
        }

        .phrase-category {
            margin-bottom: 30px;
        }

        .category-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            font-size: 1.3em;
            font-weight: bold;
        }

        .phrase-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 10px;
        }

        .phrase-item {
            background: #f9f9f9;
            padding: 15px;
            border-left: 4px solid #667eea;
            border-radius: 5px;
            transition: all 0.3s;
        }

        .phrase-item:hover {
            background: #e8e8ff;
            transform: translateX(5px);
        }

        .phrase-french {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .phrase-english {
            color: #666;
            font-size: 0.9em;
            font-style: italic;
        }

        .phrase-tags {
            margin-top: 5px;
        }

        .tag {
            display: inline-block;
            padding: 3px 8px;
            background: #667eea;
            color: white;
            border-radius: 10px;
            font-size: 0.7em;
            margin-right: 5px;
        }

        .tag.tok {
            background: #f5576c;
        }

        @media (max-width: 768px) {
            .bingo-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .phrase-items {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div style="background: #fff3cd; border: 2px solid #ffc107; padding: 15px; margin: 20px; border-radius: 10px; text-align: center;">
            <strong>üíæ Note importante:</strong> Pour sauvegarder votre progr√®s automatiquement, <strong>t√©l√©chargez ce fichier</strong> et ouvrez-le dans votre navigateur.
        </div>
        <div class="header">
            <h1>üéØ IB French B SL - BINGO</h1>
            <p>D√©crire une Image: Les Chemins de l'√âcole</p>
            <div style="margin-top: 15px; font-size: 1.1em;">
                <span id="progressDisplay">Progr√®s: 0/25 (0%)</span>
                <button onclick="resetProgress()" style="margin-left: 20px; padding: 8px 15px; background: rgba(255,255,255,0.2); border: 2px solid white; color: white; border-radius: 15px; cursor: pointer; font-weight: bold;">üîÑ R√©initialiser</button>
                <button onclick="exportProgress()" style="margin-left: 10px; padding: 8px 15px; background: rgba(255,255,255,0.2); border: 2px solid white; color: white; border-radius: 15px; cursor: pointer; font-weight: bold;">üì• Exporter</button>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('bingo')">üé≤ BINGO</button>
            <button class="tab" onclick="switchTab('phrases')">üìö Banque de Locutions</button>
        </div>

        <div id="bingo-tab" class="tab-content active">
            <div class="image-container">
                <img src="https://resize.elle.fr/original/var/plain_site/storage/images/societe/l-actu-en-images/l-epopee-de-8-enfants-sur-les-chemins-de-l-ecole-a-travers-le-monde/57080217-1-fre-FR/L-epopee-de-8-enfants-sur-les-chemins-de-l-ecole-a-travers-le-monde.jpg" alt="Enfants traversant un pont suspendu">
            </div>

            <div class="recording-indicator" id="recordingIndicator">
                üî¥ Enregistrement en cours...
            </div>

            <div class="bingo-grid" id="bingoGrid">
                <!-- Cells will be generated by JavaScript -->
            </div>
        </div>

        <div id="phrases-tab" class="tab-content">
            <div class="phrases-bank">
                <div class="filter-section">
                    <h3>üîç Filtrer par:</h3>
                    <div class="filter-buttons">
                        <button class="filter-btn active" onclick="filterPhrases('all')">Tout</button>
                        <button class="filter-btn" onclick="filterPhrases('identites')">Identit√©s</button>
                        <button class="filter-btn" onclick="filterPhrases('experiences')">Exp√©riences</button>
                        <button class="filter-btn" onclick="filterPhrases('ingeniosite')">Ing√©niosit√© Humaine</button>
                        <button class="filter-btn" onclick="filterPhrases('organisation')">Organisation Sociale</button>
                        <button class="filter-btn" onclick="filterPhrases('planete')">Partage de la Plan√®te</button>
                    </div>
                    <div class="filter-buttons" style="margin-top: 10px;">
                        <button class="filter-btn" onclick="filterPhrases('verifiable')">‚úì V√©rifiable</button>
                        <button class="filter-btn" onclick="filterPhrases('opinion')">üí≠ Opinion</button>
                        <button class="filter-btn" onclick="filterPhrases('interpretation')">üîÆ Interpr√©tation</button>
                    </div>
                </div>

                <div id="phrasesContainer">
                    <!-- Phrases will be generated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for recording -->
    <div id="recordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="close" onclick="closeModal()">&times;</span>
                <h2 id="modalTitle">T√¢che BINGO</h2>
            </div>
            <p id="modalTask" style="font-size: 1.1em; margin: 20px 0;"></p>
            <div style="text-align: center;">
                <button class="record-btn" id="startRecord" onclick="startRecording()">üé§ Commencer l'enregistrement</button>
                <button class="record-btn stop-btn" id="stopRecord" onclick="stopRecording()" style="display:none;">‚èπÔ∏è Arr√™ter</button>
                <button class="record-btn" onclick="markComplete()" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">‚úì Marquer comme termin√©</button>
                <p style="margin-top: 15px; color: #666;">Enregistrez votre r√©ponse ou marquez simplement comme termin√©</p>
                <div id="audioPlayback" style="margin-top: 20px;"></div>
            </div>
        </div>
    </div>

    <script>
        /* 
         * IB French B SL - BINGO Card
         * 
         * IMPORTANT: For progress saving to work, you must DOWNLOAD this file 
         * and open it in your browser (not in Claude.ai interface).
         * 
         * Progress is automatically saved to your browser's localStorage.
         * Your progress will persist even if you close the browser.
         * 
         * Features:
         * - 25 speaking tasks (no free space)
         * - Audio recording capability
         * - Automatic progress tracking
         * - Export progress report
         * - 100+ phrase bank with IB themes
         * - Filter by theme and TOK category
         */
        
        // BINGO tasks
        const bingoTasks = [
            "D√©crivez l'environnement naturel visible dans l'image",
            "D√©crivez les v√™tements que portent les enfants",
            "Exprimez votre opinion sur la situation avec le subjonctif",
            "Utilisez le conditionnel pour parler de ce que vous feriez",
            "D√©crivez les √©motions que l'image √©voque chez vous",
            "Comparez cette situation √† votre propre exp√©rience scolaire",
            "Parlez des dangers potentiels que vous observez",
            "Discutez de l'importance de l'√©ducation",
            "Utilisez au moins 3 adjectifs pour d√©crire le pont",
            "Expliquez pourquoi l'acc√®s √† l'√©cole peut √™tre difficile",
            "D√©crivez ce qui se passe au premier plan",
            "Imaginez la conversation entre les enfants",
            "Parlez de la g√©ographie et du climat de cette r√©gion",
            "Utilisez des expressions avec 'avoir' (avoir peur, avoir besoin)",
            "Formulez des hypoth√®ses sur la destination des enfants",
            "Discutez des d√©fis de l'√©ducation rurale",
            "D√©crivez la construction du pont",
            "Comparez l'√©ducation dans diff√©rentes r√©gions du monde",
            "Utilisez le pass√© compos√© pour imaginer ce qui s'est pass√© avant",
            "Exprimez l'admiration ou la pr√©occupation",
            "Parlez des droits de l'enfant",
            "D√©crivez la relation entre les enfants",
            "Utilisez 'il faut que' + subjonctif",
            "Discutez du r√¥le de la communaut√© dans l'√©ducation",
            "Concluez avec une r√©flexion personnelle sur l'image"
        ];

        // Comprehensive phrases bank
        const phrasesData = [
            // IDENTIT√âS - V√©rifiable
            { fr: "On peut voir des enfants en uniforme scolaire", en: "We can see children in school uniform", themes: ["identites"], tok: "verifiable" },
            { fr: "Les enfants portent des sacs √† dos", en: "The children are wearing backpacks", themes: ["identites"], tok: "verifiable" },
            { fr: "Il y a plusieurs filles avec des rubans roses dans les cheveux", en: "There are several girls with pink ribbons in their hair", themes: ["identites"], tok: "verifiable" },
            { fr: "Les uniformes sont compos√©s de chemises blanches et de jupes grises", en: "The uniforms consist of white shirts and grey skirts", themes: ["identites"], tok: "verifiable" },
            { fr: "Ce sont des √©l√®ves du primaire", en: "These are primary school students", themes: ["identites"], tok: "interpretation" },
            { fr: "Les enfants semblent avoir entre 7 et 12 ans", en: "The children appear to be between 7 and 12 years old", themes: ["identites"], tok: "interpretation" },
            { fr: "Certains enfants portent des sandales, d'autres sont pieds nus", en: "Some children wear sandals, others are barefoot", themes: ["identites"], tok: "verifiable" },
            
            // IDENTIT√âS - Opinion
            { fr: "Ces enfants font preuve d'un courage remarquable", en: "These children show remarkable courage", themes: ["identites"], tok: "opinion" },
            { fr: "Je trouve que leur d√©termination est inspirante", en: "I find their determination inspiring", themes: ["identites"], tok: "opinion" },
            { fr: "√Ä mon avis, ils sont tr√®s courageux", en: "In my opinion, they are very brave", themes: ["identites"], tok: "opinion" },
            { fr: "Il me semble que ces enfants sont r√©silients", en: "It seems to me that these children are resilient", themes: ["identites"], tok: "opinion" },

            // EXP√âRIENCES - V√©rifiable
            { fr: "Les enfants traversent un pont suspendu pr√©caire", en: "The children are crossing a precarious suspension bridge", themes: ["experiences"], tok: "verifiable" },
            { fr: "Le pont est construit avec des planches de bois et des cordes", en: "The bridge is built with wooden planks and ropes", themes: ["experiences"], tok: "verifiable" },
            { fr: "Il y a une rivi√®re ou un ravin en dessous", en: "There is a river or ravine below", themes: ["experiences"], tok: "verifiable" },
            { fr: "Les enfants se tiennent aux c√¢bles pour garder l'√©quilibre", en: "The children hold onto the cables to keep their balance", themes: ["experiences"], tok: "verifiable" },
            { fr: "La v√©g√©tation environnante est luxuriante et tropicale", en: "The surrounding vegetation is lush and tropical", themes: ["experiences", "planete"], tok: "verifiable" },
            { fr: "Le pont semble s'√©tendre sur une distance consid√©rable", en: "The bridge appears to extend over a considerable distance", themes: ["experiences"], tok: "verifiable" },
            
            // EXP√âRIENCES - Opinion
            { fr: "Ce trajet quotidien doit √™tre √©puisant", en: "This daily journey must be exhausting", themes: ["experiences"], tok: "opinion" },
            { fr: "J'imagine que cette exp√©rience les rend plus forts", en: "I imagine this experience makes them stronger", themes: ["experiences"], tok: "opinion" },
            { fr: "Il est probable qu'ils aient peur chaque jour", en: "It's likely that they're afraid every day", themes: ["experiences"], tok: "interpretation" },
            { fr: "Cette exp√©rience forge s√ªrement leur caract√®re", en: "This experience surely builds their character", themes: ["experiences"], tok: "opinion" },

            // ING√âNIOSIT√â HUMAINE - V√©rifiable
            { fr: "Le pont repr√©sente une solution ing√©nieuse √† un probl√®me de transport", en: "The bridge represents an ingenious solution to a transport problem", themes: ["ingeniosite"], tok: "interpretation" },
            { fr: "La construction utilise des mat√©riaux locaux disponibles", en: "The construction uses available local materials", themes: ["ingeniosite"], tok: "verifiable" },
            { fr: "Les cordes torsad√©es servent de garde-corps", en: "Twisted ropes serve as handrails", themes: ["ingeniosite"], tok: "verifiable" },
            { fr: "Les planches de bois forment le passage", en: "Wooden planks form the walkway", themes: ["ingeniosite"], tok: "verifiable" },
            { fr: "C'est une solution de faible technologie mais efficace", en: "It's a low-tech but effective solution", themes: ["ingeniosite"], tok: "opinion" },
            { fr: "La communaut√© a d√ª travailler ensemble pour construire ce pont", en: "The community must have worked together to build this bridge", themes: ["ingeniosite", "organisation"], tok: "interpretation" },

            // ORGANISATION SOCIALE - V√©rifiable
            { fr: "L'acc√®s √† l'√©cole n√©cessite des infrastructures", en: "Access to school requires infrastructure", themes: ["organisation"], tok: "verifiable" },
            { fr: "Le droit √† l'√©ducation est un droit fondamental", en: "The right to education is a fundamental right", themes: ["organisation"], tok: "verifiable" },
            { fr: "Ces enfants doivent surmonter des obstacles g√©ographiques", en: "These children must overcome geographical obstacles", themes: ["organisation", "planete"], tok: "verifiable" },
            { fr: "L'in√©galit√© d'acc√®s √† l'√©ducation est visible", en: "Inequality in access to education is visible", themes: ["organisation"], tok: "interpretation" },
            
            // ORGANISATION SOCIALE - Opinion
            { fr: "Il faudrait que les gouvernements investissent dans l'√©ducation rurale", en: "Governments should invest in rural education", themes: ["organisation"], tok: "opinion" },
            { fr: "Il est essentiel que tous les enfants aient un acc√®s s√ªr √† l'√©cole", en: "It is essential that all children have safe access to school", themes: ["organisation"], tok: "opinion" },
            { fr: "Je pense que l'√©ducation devrait √™tre accessible √† tous", en: "I think education should be accessible to everyone", themes: ["organisation"], tok: "opinion" },
            { fr: "Il serait n√©cessaire de construire des ponts plus solides", en: "It would be necessary to build stronger bridges", themes: ["organisation"], tok: "opinion" },

            // PARTAGE DE LA PLAN√àTE - V√©rifiable
            { fr: "Le paysage est montagneux et couvert de for√™t", en: "The landscape is mountainous and covered with forest", themes: ["planete"], tok: "verifiable" },
            { fr: "La v√©g√©tation indique un climat tropical ou subtropical", en: "The vegetation indicates a tropical or subtropical climate", themes: ["planete"], tok: "interpretation" },
            { fr: "Le terrain accident√© cr√©e des d√©fis de mobilit√©", en: "The rugged terrain creates mobility challenges", themes: ["planete"], tok: "verifiable" },
            { fr: "Les arbres fournissent probablement l'ombre n√©cessaire", en: "The trees probably provide necessary shade", themes: ["planete"], tok: "interpretation" },
            
            // DESCRIBING THE IMAGE - Physical Description
            { fr: "Au premier plan, on distingue quatre ou cinq enfants", en: "In the foreground, we can see four or five children", themes: ["identites"], tok: "verifiable" },
            { fr: "√Ä l'arri√®re-plan, la for√™t dense s'√©tend", en: "In the background, the dense forest extends", themes: ["planete"], tok: "verifiable" },
            { fr: "Le pont se balance au-dessus du vide", en: "The bridge sways above the void", themes: ["experiences"], tok: "interpretation" },
            { fr: "La lumi√®re du soleil filtre √† travers les arbres", en: "Sunlight filters through the trees", themes: ["planete"], tok: "verifiable" },
            
            // EMOTIONS AND REACTIONS
            { fr: "Cette image √©voque un sentiment d'inqui√©tude", en: "This image evokes a feeling of worry", themes: ["identites", "experiences"], tok: "opinion" },
            { fr: "Je ressens de l'admiration pour ces enfants", en: "I feel admiration for these children", themes: ["identites"], tok: "opinion" },
            { fr: "Cela me rend conscient de mes privil√®ges", en: "This makes me aware of my privileges", themes: ["identites"], tok: "opinion" },
            { fr: "Je suis impressionn√©(e) par leur bravoure", en: "I am impressed by their bravery", themes: ["identites"], tok: "opinion" },
            { fr: "Cette situation me pr√©occupe", en: "This situation concerns me", themes: ["experiences"], tok: "opinion" },
            
            // CONDITIONAL STATEMENTS
            { fr: "Si j'√©tais √† leur place, j'aurais peur", en: "If I were in their place, I would be afraid", themes: ["experiences"], tok: "opinion" },
            { fr: "√Ä leur place, je serais terrifi√©(e)", en: "In their place, I would be terrified", themes: ["experiences"], tok: "opinion" },
            { fr: "Si nous avions les moyens, nous construirions un pont plus s√ªr", en: "If we had the means, we would build a safer bridge", themes: ["organisation"], tok: "opinion" },
            { fr: "Avec plus de ressources, on pourrait am√©liorer la situation", en: "With more resources, we could improve the situation", themes: ["organisation"], tok: "opinion" },
            
            // SUBJUNCTIVE EXPRESSIONS
            { fr: "Il faut que les autorit√©s prennent des mesures", en: "The authorities must take action", themes: ["organisation"], tok: "opinion" },
            { fr: "Il est important que tous les enfants puissent aller √† l'√©cole en s√©curit√©", en: "It's important that all children can go to school safely", themes: ["organisation"], tok: "opinion" },
            { fr: "Je doute que cette situation soit acceptable", en: "I doubt this situation is acceptable", themes: ["organisation"], tok: "opinion" },
            { fr: "Il est n√©cessaire qu'on am√©liore l'infrastructure", en: "It's necessary that we improve the infrastructure", themes: ["organisation"], tok: "opinion" },
            { fr: "Bien que ce soit dangereux, ils continuent", en: "Although it's dangerous, they continue", themes: ["experiences"], tok: "verifiable" },
            
            // COMPARISONS
            { fr: "Contrairement √† ma propre exp√©rience, ces enfants...", en: "Unlike my own experience, these children...", themes: ["identites", "experiences"], tok: "opinion" },
            { fr: "Par rapport √† mon chemin vers l'√©cole, le leur est...", en: "Compared to my way to school, theirs is...", themes: ["experiences"], tok: "opinion" },
            { fr: "Dans mon pays, l'acc√®s √† l'√©cole est beaucoup plus facile", en: "In my country, access to school is much easier", themes: ["organisation"], tok: "opinion" },
            { fr: "Cette situation diff√®re √©norm√©ment de la mienne", en: "This situation differs enormously from mine", themes: ["experiences"], tok: "opinion" },
            
            // EXPRESSING NECESSITY AND OBLIGATION
            { fr: "Il est imp√©ratif de garantir la s√©curit√© des enfants", en: "It is imperative to guarantee children's safety", themes: ["organisation"], tok: "opinion" },
            { fr: "On doit investir dans l'√©ducation rurale", en: "We must invest in rural education", themes: ["organisation"], tok: "opinion" },
            { fr: "Il faudrait construire des infrastructures plus solides", en: "We should build stronger infrastructure", themes: ["organisation"], tok: "opinion" },
            { fr: "Les enfants m√©ritent un acc√®s s√ªr √† l'√©ducation", en: "Children deserve safe access to education", themes: ["organisation"], tok: "opinion" },
            
            // DESCRIBING ACTIONS
            { fr: "Les enfants avancent prudemment", en: "The children advance cautiously", themes: ["experiences"], tok: "verifiable" },
            { fr: "Ils s'agrippent fermement aux cordes", en: "They grip the ropes firmly", themes: ["experiences"], tok: "verifiable" },
            { fr: "Ils progressent lentement pour maintenir l'√©quilibre", en: "They progress slowly to maintain balance", themes: ["experiences"], tok: "interpretation" },
            { fr: "Ils marchent en file indienne", en: "They walk in single file", themes: ["experiences"], tok: "verifiable" },
            { fr: "Chaque pas n√©cessite de la concentration", en: "Each step requires concentration", themes: ["experiences"], tok: "interpretation" },
            
            // DANGERS AND RISKS
            { fr: "Le pont pr√©sente des risques √©vidents", en: "The bridge presents obvious risks", themes: ["experiences"], tok: "verifiable" },
            { fr: "Les planches pourraient c√©der √† tout moment", en: "The planks could give way at any moment", themes: ["experiences"], tok: "interpretation" },
            { fr: "Une chute serait dangereuse, voire mortelle", en: "A fall would be dangerous, even fatal", themes: ["experiences"], tok: "interpretation" },
            { fr: "Les intemp√©ries rendent le pont encore plus p√©rilleux", en: "Bad weather makes the bridge even more perilous", themes: ["experiences", "planete"], tok: "interpretation" },
            
            // EDUCATION THEMES
            { fr: "L'√©ducation est la cl√© du d√©veloppement", en: "Education is the key to development", themes: ["organisation"], tok: "opinion" },
            { fr: "Malgr√© les obstacles, ces enfants poursuivent leurs √©tudes", en: "Despite the obstacles, these children pursue their studies", themes: ["experiences"], tok: "interpretation" },
            { fr: "La pers√©v√©rance de ces √©l√®ves est admirable", en: "The perseverance of these students is admirable", themes: ["identites"], tok: "opinion" },
            { fr: "L'acc√®s √† l'√©cole ne devrait pas √™tre un d√©fi quotidien", en: "Access to school should not be a daily challenge", themes: ["organisation"], tok: "opinion" },
            
            // CULTURAL AND GEOGRAPHICAL CONTEXT
            { fr: "Cette sc√®ne pourrait se d√©rouler en Asie du Sud-Est", en: "This scene could take place in Southeast Asia", themes: ["planete"], tok: "interpretation" },
            { fr: "Les r√©gions montagneuses posent des d√©fis uniques", en: "Mountainous regions pose unique challenges", themes: ["planete"], tok: "verifiable" },
            { fr: "Le climat tropical influence la vie quotidienne", en: "The tropical climate influences daily life", themes: ["planete"], tok: "interpretation" },
            { fr: "La g√©ographie d√©termine souvent l'acc√®s aux services", en: "Geography often determines access to services", themes: ["organisation", "planete"], tok: "interpretation" },
            
            // COMMUNITY AND SOLIDARITY
            { fr: "Les enfants font preuve de solidarit√©", en: "The children show solidarity", themes: ["identites", "organisation"], tok: "interpretation" },
            { fr: "La communaut√© doit se soutenir mutuellement", en: "The community must support each other", themes: ["organisation"], tok: "opinion" },
            { fr: "Ensemble, ils surmontent les difficult√©s", en: "Together, they overcome difficulties", themes: ["experiences"], tok: "interpretation" },
            { fr: "L'entraide est essentielle dans ces conditions", en: "Mutual help is essential in these conditions", themes: ["organisation"], tok: "opinion" },
            
            // EMOTIONAL VOCABULARY
            { fr: "Cette image suscite de l'empathie", en: "This image arouses empathy", themes: ["identites"], tok: "opinion" },
            { fr: "On ressent un m√©lange de crainte et d'espoir", en: "We feel a mixture of fear and hope", themes: ["experiences"], tok: "opinion" },
            { fr: "Leur d√©termination inspire le respect", en: "Their determination inspires respect", themes: ["identites"], tok: "opinion" },
            { fr: "Cette situation provoque une r√©flexion profonde", en: "This situation provokes deep reflection", themes: ["identites"], tok: "opinion" },
            
            // HYPOTHETICAL SITUATIONS
            { fr: "Si le pont s'effondrait, les cons√©quences seraient graves", en: "If the bridge collapsed, the consequences would be serious", themes: ["experiences"], tok: "interpretation" },
            { fr: "Sans ce pont, l'acc√®s √† l'√©cole serait impossible", en: "Without this bridge, access to school would be impossible", themes: ["organisation"], tok: "interpretation" },
            { fr: "Avec un meilleur financement, on pourrait am√©liorer la s√©curit√©", en: "With better funding, we could improve safety", themes: ["organisation"], tok: "opinion" },
            
            // TIME EXPRESSIONS
            { fr: "Chaque jour, ces enfants bravent le danger", en: "Every day, these children brave danger", themes: ["experiences"], tok: "interpretation" },
            { fr: "Depuis des ann√©es, ce pont sert de passage", en: "For years, this bridge has served as a passage", themes: ["ingeniosite"], tok: "interpretation" },
            { fr: "Pendant la saison des pluies, la travers√©e est encore plus difficile", en: "During the rainy season, the crossing is even more difficult", themes: ["experiences", "planete"], tok: "interpretation" },
            
            // CAUSE AND EFFECT
            { fr: "En raison du terrain montagneux, il n'y a pas d'autre route", en: "Due to the mountainous terrain, there is no other route", themes: ["planete"], tok: "interpretation" },
            { fr: "Par cons√©quent, les enfants doivent utiliser ce pont", en: "Consequently, the children must use this bridge", themes: ["experiences"], tok: "interpretation" },
            { fr: "√Ä cause du manque de ressources, l'infrastructure est insuffisante", en: "Because of lack of resources, the infrastructure is insufficient", themes: ["organisation"], tok: "interpretation" },
            
            // SOLUTIONS AND RECOMMENDATIONS
            { fr: "Il conviendrait de construire un pont plus s√ªr", en: "It would be appropriate to build a safer bridge", themes: ["organisation"], tok: "opinion" },
            { fr: "Les ONG pourraient intervenir pour am√©liorer la situation", en: "NGOs could intervene to improve the situation", themes: ["organisation"], tok: "opinion" },
            { fr: "Un investissement dans l'infrastructure serait b√©n√©fique", en: "An investment in infrastructure would be beneficial", themes: ["organisation"], tok: "opinion" },
            { fr: "La communaut√© internationale devrait soutenir ces r√©gions", en: "The international community should support these regions", themes: ["organisation"], tok: "opinion" },
            
            // PERSONAL REFLECTION
            { fr: "Cette image me fait r√©fl√©chir √† mes propres privil√®ges", en: "This image makes me reflect on my own privileges", themes: ["identites"], tok: "opinion" },
            { fr: "Je prends conscience des in√©galit√©s mondiales", en: "I become aware of global inequalities", themes: ["organisation"], tok: "opinion" },
            { fr: "Cela remet en perspective mes propres difficult√©s", en: "This puts my own difficulties into perspective", themes: ["identites"], tok: "opinion" },
            { fr: "Je me sens motiv√©(e) √† contribuer au changement", en: "I feel motivated to contribute to change", themes: ["identites"], tok: "opinion" },
            
            // DESCRIPTIVE ADJECTIVES
            { fr: "Le pont est pr√©caire, instable et dangereux", en: "The bridge is precarious, unstable and dangerous", themes: ["experiences"], tok: "opinion" },
            { fr: "Les enfants sont courageux, d√©termin√©s et r√©silients", en: "The children are courageous, determined and resilient", themes: ["identites"], tok: "opinion" },
            { fr: "La situation est pr√©occupante mais inspirante", en: "The situation is concerning but inspiring", themes: ["experiences"], tok: "opinion" },
            { fr: "L'environnement est √† la fois magnifique et hostile", en: "The environment is both beautiful and hostile", themes: ["planete"], tok: "opinion" },
            
            // CONNECTING TO GLOBAL ISSUES
            { fr: "Cette image illustre les d√©fis du d√©veloppement durable", en: "This image illustrates the challenges of sustainable development", themes: ["organisation", "planete"], tok: "interpretation" },
            { fr: "Elle met en lumi√®re les Objectifs de D√©veloppement Durable", en: "It highlights the Sustainable Development Goals", themes: ["organisation"], tok: "interpretation" },
            { fr: "C'est un exemple concret d'in√©galit√© d'acc√®s √† l'√©ducation", en: "This is a concrete example of inequality in access to education", themes: ["organisation"], tok: "interpretation" },
            { fr: "Elle r√©v√®le les disparit√©s entre zones urbaines et rurales", en: "It reveals disparities between urban and rural areas", themes: ["organisation"], tok: "interpretation" }
        ];

        let mediaRecorder;
        let audioChunks = [];
        let currentTask = -1;
        let completedTasks = new Set();

        // Load saved progress from localStorage
        function loadProgress() {
            try {
                const saved = localStorage.getItem('ibFrenchBingoProgress');
                if (saved) {
                    const savedTasks = JSON.parse(saved);
                    completedTasks = new Set(savedTasks);
                    updateProgressDisplay();
                    
                    // Update visual state of cells
                    const cells = document.querySelectorAll('.bingo-cell');
                    completedTasks.forEach(taskIndex => {
                        if (cells[taskIndex]) {
                            cells[taskIndex].classList.add('completed');
                        }
                    });
                }
            } catch (error) {
                console.log('Could not load progress from localStorage');
            }
        }

        // Save progress to localStorage
        function saveProgress() {
            try {
                localStorage.setItem('ibFrenchBingoProgress', JSON.stringify([...completedTasks]));
            } catch (error) {
                console.log('Could not save progress to localStorage');
            }
        }

        // Update progress display
        function updateProgressDisplay() {
            const total = bingoTasks.length;
            const completed = completedTasks.size;
            const percentage = Math.round((completed / total) * 100);
            document.getElementById('progressDisplay').textContent = `Progr√®s: ${completed}/${total} (${percentage}%)`;
            
            // Check if all tasks completed
            if (completed === total && completed > 0) {
                setTimeout(() => {
                    alert('üéâ F√âLICITATIONS! üéâ\n\nVous avez termin√© toutes les t√¢ches BINGO!\nVous avez fait un excellent travail en pratiquant votre fran√ßais oral.\n\nN\'oubliez pas d\'exporter votre progr√®s!');
                }, 500);
            }
        }

        // Reset all progress
        function resetProgress() {
            if (confirm('√ätes-vous s√ªr de vouloir r√©initialiser tout votre progr√®s?')) {
                completedTasks.clear();
                saveProgress();
                updateProgressDisplay();
                
                // Remove completed class from all cells
                document.querySelectorAll('.bingo-cell').forEach(cell => {
                    cell.classList.remove('completed');
                });
            }
        }

        // Initialize the BINGO grid
        function initBingo() {
            const grid = document.getElementById('bingoGrid');
            bingoTasks.forEach((task, index) => {
                const cell = document.createElement('div');
                cell.className = 'bingo-cell';
                cell.textContent = task;
                cell.onclick = () => openModal(index, task);
                grid.appendChild(cell);
            });
        }

        // Initialize phrases bank
        function initPhrases() {
            displayPhrases(phrasesData);
        }

        function displayPhrases(phrases) {
            const container = document.getElementById('phrasesContainer');
            container.innerHTML = '';

            const categories = {
                'verifiable': { title: '‚úì Faits V√©rifiables', color: '#11998e' },
                'interpretation': { title: 'üîÆ Interpr√©tations', color: '#667eea' },
                'opinion': { title: 'üí≠ Opinions et Jugements', color: '#f5576c' }
            };

            Object.keys(categories).forEach(tokType => {
                const categoryPhrases = phrases.filter(p => p.tok === tokType);
                if (categoryPhrases.length === 0) return;

                const section = document.createElement('div');
                section.className = 'phrase-category';
                
                const header = document.createElement('div');
                header.className = 'category-header';
                header.style.background = `linear-gradient(135deg, ${categories[tokType].color} 0%, ${categories[tokType].color}dd 100%)`;
                header.textContent = `${categories[tokType].title} (${categoryPhrases.length})`;
                
                const items = document.createElement('div');
                items.className = 'phrase-items';
                
                categoryPhrases.forEach(phrase => {
                    const item = document.createElement('div');
                    item.className = 'phrase-item';
                    item.innerHTML = `
                        <div class="phrase-french">${phrase.fr}</div>
                        <div class="phrase-english">${phrase.en}</div>
                        <div class="phrase-tags">
                            <span class="tag tok">${phrase.tok}</span>
                            ${phrase.themes.map(theme => `<span class="tag">${theme}</span>`).join('')}
                        </div>
                    `;
                    items.appendChild(item);
                });
                
                section.appendChild(header);
                section.appendChild(items);
                container.appendChild(section);
            });
        }

        function filterPhrases(filter) {
            // Update active button
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            let filtered = phrasesData;
            
            if (filter !== 'all') {
                if (['identites', 'experiences', 'ingeniosite', 'organisation', 'planete'].includes(filter)) {
                    filtered = phrasesData.filter(p => p.themes.includes(filter));
                } else if (['verifiable', 'opinion', 'interpretation'].includes(filter)) {
                    filtered = phrasesData.filter(p => p.tok === filter);
                }
            }
            
            displayPhrases(filtered);
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(`${tab}-tab`).classList.add('active');
        }

        function openModal(index, task) {
            currentTask = index;
            const isCompleted = completedTasks.has(index);
            
            document.getElementById('modalTitle').textContent = `T√¢che #${index + 1}${isCompleted ? ' ‚úì' : ''}`;
            document.getElementById('modalTask').textContent = task;
            document.getElementById('recordModal').style.display = 'block';
            document.getElementById('audioPlayback').innerHTML = '';
            
            // Show appropriate message if already completed
            if (isCompleted) {
                document.getElementById('audioPlayback').innerHTML = '<p style="color: #11998e; font-weight: bold;">‚úì Cette t√¢che est d√©j√† termin√©e!</p><button onclick="unmarkComplete()" class="record-btn" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%); margin-top: 10px;">‚Ü©Ô∏è Marquer comme non termin√©</button>';
            }
            
            // Reset buttons
            document.getElementById('startRecord').style.display = 'inline-block';
            document.getElementById('stopRecord').style.display = 'none';
        }
        
        // Unmark task as complete
        function unmarkComplete() {
            if (currentTask === -1) return;
            
            completedTasks.delete(currentTask);
            const cells = document.querySelectorAll('.bingo-cell');
            cells[currentTask].classList.remove('completed');
            
            saveProgress();
            updateProgressDisplay();
            
            document.getElementById('audioPlayback').innerHTML = '<p style="color: #666; font-weight: bold;">T√¢che marqu√©e comme non termin√©e</p>';
            document.getElementById('modalTitle').textContent = `T√¢che #${currentTask + 1}`;
        }

        function closeModal() {
            document.getElementById('recordModal').style.display = 'none';
            if (mediaRecorder && mediaRecorder.state === 'recording') {
                stopRecording();
            }
        }

        async function startRecording() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                mediaRecorder = new MediaRecorder(stream);
                audioChunks = [];

                mediaRecorder.ondataavailable = (event) => {
                    audioChunks.push(event.data);
                };

                mediaRecorder.onstop = () => {
                    const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                    const audioUrl = URL.createObjectURL(audioBlob);
                    const audio = document.createElement('audio');
                    audio.controls = true;
                    audio.src = audioUrl;
                    
                    document.getElementById('audioPlayback').innerHTML = '<p style="color: #11998e; font-weight: bold;">‚úì Enregistrement termin√©!</p>';
                    document.getElementById('audioPlayback').appendChild(audio);
                    
                    // Mark task as completed
                    completedTasks.add(currentTask);
                    const cells = document.querySelectorAll('.bingo-cell');
                    cells[currentTask].classList.add('completed');
                    
                    // Save progress and update display
                    saveProgress();
                    updateProgressDisplay();
                    
                    // Stop all tracks
                    stream.getTracks().forEach(track => track.stop());
                };

                mediaRecorder.start();
                document.getElementById('recordingIndicator').classList.add('active');
                document.getElementById('startRecord').style.display = 'none';
                document.getElementById('stopRecord').style.display = 'inline-block';
                
            } catch (error) {
                alert('Erreur: Impossible d\'acc√©der au microphone. Veuillez autoriser l\'acc√®s au microphone.');
            }
        }

        function stopRecording() {
            if (mediaRecorder && mediaRecorder.state === 'recording') {
                mediaRecorder.stop();
                document.getElementById('recordingIndicator').classList.remove('active');
                document.getElementById('startRecord').style.display = 'inline-block';
                document.getElementById('stopRecord').style.display = 'none';
            }
        }

        // Mark task as complete without recording
        function markComplete() {
            if (currentTask === -1) return;
            
            completedTasks.add(currentTask);
            const cells = document.querySelectorAll('.bingo-cell');
            cells[currentTask].classList.add('completed');
            
            saveProgress();
            updateProgressDisplay();
            
            document.getElementById('audioPlayback').innerHTML = '<p style="color: #11998e; font-weight: bold;">‚úì T√¢che marqu√©e comme termin√©e!</p>';
        }

        // Export progress as a text file
        function exportProgress() {
            const completed = Array.from(completedTasks).sort((a, b) => a - b);
            const date = new Date().toLocaleDateString('fr-FR');
            
            let report = `IB French B SL - BINGO Progress Report\n`;
            report += `Date: ${date}\n`;
            report += `Progr√®s: ${completed.length}/${bingoTasks.length} (${Math.round((completed.length / bingoTasks.length) * 100)}%)\n\n`;
            report += `=== T√ÇCHES TERMIN√âES ===\n\n`;
            
            completed.forEach(index => {
                report += `‚úì T√¢che #${index + 1}: ${bingoTasks[index]}\n\n`;
            });
            
            if (completed.length < bingoTasks.length) {
                report += `\n=== T√ÇCHES RESTANTES ===\n\n`;
                bingoTasks.forEach((task, index) => {
                    if (!completedTasks.has(index)) {
                        report += `‚òê T√¢che #${index + 1}: ${task}\n\n`;
                    }
                });
            }
            
            // Create download
            const blob = new Blob([report], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `BINGO-Progress-${date}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('recordModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Initialize on load
        window.onload = function() {
            initBingo();
            initPhrases();
            loadProgress();
        };
    </script>
</body>
</html>