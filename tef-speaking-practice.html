<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TEF Canada ‚Äî Expression orale NCLC 8</title>
    <link href="https://fonts.googleapis.com/css2?family=Source+Serif+4:opsz,wght@8..60,400;8..60,600;8..60,700&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0f1419;
            --bg-secondary: #1a2332;
            --bg-tertiary: #243044;
            --accent-blue: #3b82f6;
            --accent-green: #10b981;
            --accent-yellow: #f59e0b;
            --accent-red: #ef4444;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-color: #334155;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border-color);
        }

        .header h1 {
            font-family: 'Source Serif 4', serif;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; }

        .level-badge {
            display: inline-block;
            background: var(--accent-blue);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 0.75rem;
        }

        /* API Panel */
        .api-panel {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 2rem;
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .api-panel input {
            flex: 1;
            min-width: 200px;
            padding: 0.6rem 1rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.9rem;
            font-family: monospace;
        }

        .api-panel input:focus { outline: none; border-color: var(--accent-blue); }

        .api-status {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.85rem;
            background: var(--bg-tertiary);
        }

        .api-status.active { background: rgba(16, 185, 129, 0.2); color: var(--accent-green); }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
        }

        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-primary { background: var(--accent-blue); color: white; }
        .btn-primary:hover:not(:disabled) { background: #2563eb; }
        .btn-secondary { background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); }
        .btn-small { padding: 0.5rem 1rem; font-size: 0.85rem; }

        /* Screens */
        .screen { display: none; }
        .screen.active { display: block; }

        /* Scenario Cards */
        .scenario-grid { display: grid; gap: 1rem; }

        .scenario-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .scenario-card:hover { border-color: var(--accent-blue); transform: translateY(-2px); }

        .scenario-icon {
            font-size: 2rem;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-tertiary);
            border-radius: 12px;
        }

        .scenario-info h3 { font-size: 1.1rem; margin-bottom: 0.25rem; }
        .scenario-info p { font-size: 0.9rem; color: var(--text-secondary); }

        /* Context Screen */
        .context-box {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
        }

        .context-title {
            font-family: 'Source Serif 4', serif;
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .context-text {
            text-align: left;
            background: var(--bg-tertiary);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            line-height: 1.8;
        }

        .context-objective {
            text-align: left;
            padding: 1rem 1.5rem;
            background: rgba(59, 130, 246, 0.1);
            border-left: 3px solid var(--accent-blue);
            border-radius: 0 8px 8px 0;
            margin-bottom: 2rem;
        }

        /* Dialogue Screen */
        .progress-bar {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 10px;
        }

        .progress-step {
            flex: 1;
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
        }

        .progress-step.done { background: var(--accent-green); }
        .progress-step.current { background: var(--accent-blue); }

        .progress-text {
            font-size: 0.85rem;
            color: var(--text-secondary);
            white-space: nowrap;
            margin-left: 0.5rem;
        }

        .interviewer-box {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .interviewer-label {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .interviewer-text {
            font-family: 'Source Serif 4', serif;
            font-size: 1.2rem;
            line-height: 1.7;
            padding: 1.25rem;
            background: var(--bg-tertiary);
            border-radius: 12px;
            border-left: 3px solid var(--accent-blue);
        }

        .audio-btn {
            margin-top: 1rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-secondary);
            font-size: 0.85rem;
            cursor: pointer;
        }

        .audio-btn:hover { border-color: var(--accent-blue); color: var(--accent-blue); }

        /* Questions */
        .questions-section { margin-bottom: 1.5rem; }
        .questions-section h3 { font-size: 1rem; color: var(--text-secondary); margin-bottom: 1rem; font-weight: 500; }

        .question-list { display: flex; flex-direction: column; gap: 0.75rem; }

        .question-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem 1.25rem;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .question-item:hover { border-color: var(--accent-blue); background: var(--bg-tertiary); }
        .question-item.selected { border-color: var(--accent-blue); background: rgba(59, 130, 246, 0.1); }

        .question-radio {
            width: 22px;
            height: 22px;
            border: 2px solid var(--border-color);
            border-radius: 50%;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 2px;
        }

        .question-item.selected .question-radio {
            border-color: var(--accent-blue);
            background: var(--accent-blue);
        }

        .question-item.selected .question-radio::after {
            content: '';
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
        }

        .question-content { font-size: 1rem; line-height: 1.6; }

        .validate-row { display: flex; justify-content: flex-end; margin-bottom: 1.5rem; }

        /* Feedback */
        .feedback-box {
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            display: none;
        }

        .feedback-box.visible { display: block; }

        .feedback-box.mauvaise { background: rgba(239, 68, 68, 0.1); border: 1px solid var(--accent-red); }
        .feedback-box.acceptable { background: rgba(245, 158, 11, 0.1); border: 1px solid var(--accent-yellow); }
        .feedback-box.ideale { background: rgba(16, 185, 129, 0.1); border: 1px solid var(--accent-green); }

        .feedback-header { display: flex; align-items: center; gap: 0.5rem; font-weight: 600; margin-bottom: 0.75rem; }
        .feedback-box.mauvaise .feedback-header { color: var(--accent-red); }
        .feedback-box.acceptable .feedback-header { color: var(--accent-yellow); }
        .feedback-box.ideale .feedback-header { color: var(--accent-green); }

        .feedback-content { color: var(--text-secondary); line-height: 1.7; margin-bottom: 1rem; }
        .feedback-actions { display: flex; gap: 0.75rem; }

        /* Results */
        .results-box {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
        }

        .results-box h2 { font-family: 'Source Serif 4', serif; font-size: 1.75rem; margin-bottom: 0.5rem; }
        .results-subtitle { color: var(--text-secondary); margin-bottom: 1.5rem; }

        .score-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-bottom: 2rem; }

        .score-card { padding: 1.25rem; background: var(--bg-tertiary); border-radius: 12px; }
        .score-card .num { font-size: 2rem; font-weight: 700; }
        .score-card .label { font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem; }
        .score-card.green .num { color: var(--accent-green); }
        .score-card.yellow .num { color: var(--accent-yellow); }
        .score-card.red .num { color: var(--accent-red); }

        .nclc-box { background: var(--bg-tertiary); padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem; }
        .nclc-box .level { font-size: 2.5rem; font-weight: 700; color: var(--accent-blue); }
        .nclc-box .label { color: var(--text-secondary); font-size: 0.9rem; }

        .tips-box { text-align: left; background: var(--bg-tertiary); padding: 1.25rem; border-radius: 12px; margin-bottom: 1.5rem; }
        .tips-box h4 { font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.75rem; }
        .tips-box ul { list-style: none; }
        .tips-box li { padding: 0.5rem 0; padding-left: 1.5rem; position: relative; color: var(--text-secondary); }
        .tips-box li::before { content: '‚Üí'; position: absolute; left: 0; color: var(--accent-blue); }

        .results-actions { display: flex; gap: 1rem; justify-content: center; }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>TEF Canada ‚Äî Expression orale</h1>
            <p class="subtitle">Section A : Obtenir des renseignements</p>
            <span class="level-badge">Niveau cible : NCLC 8</span>
        </header>

        <!-- API Panel -->
        <div class="api-panel">
            <span>üîë</span>
            <input type="password" id="apiKey" placeholder="Cl√© API ElevenLabs">
            <button class="btn btn-primary btn-small" onclick="App.activateVoice()">Activer</button>
            <div class="api-status" id="apiStatus">üîá Voix d√©sactiv√©e</div>
        </div>

        <!-- Screen: Scenario Selection -->
        <div class="screen active" id="screenSelect">
            <h2 style="font-size: 1.1rem; color: var(--text-secondary); margin-bottom: 1rem;">Choisissez un sc√©nario :</h2>
            <div class="scenario-grid" id="scenarioList"></div>
        </div>

        <!-- Screen: Context -->
        <div class="screen" id="screenContext">
            <div class="context-box">
                <div class="context-title" id="ctxTitle"></div>
                <div class="context-text" id="ctxText"></div>
                <div class="context-objective" id="ctxObjective"></div>
                <button class="btn btn-primary" onclick="App.startDialogue()">Commencer l'appel ‚ñ∂</button>
            </div>
        </div>

        <!-- Screen: Dialogue -->
        <div class="screen" id="screenDialogue">
            <div class="progress-bar" id="progressBar"></div>

            <div class="interviewer-box">
                <div class="interviewer-label">üéß L'interlocuteur :</div>
                <div class="interviewer-text" id="interviewerText"></div>
                <button class="audio-btn" onclick="App.playAudio()">üîä √âcouter</button>
            </div>

            <div class="questions-section" id="questionsSection">
                <h3>Choisissez votre question :</h3>
                <div class="question-list" id="questionList"></div>
            </div>

            <div class="validate-row" id="validateRow">
                <button class="btn btn-primary" id="btnValidate" onclick="App.validate()" disabled>Valider ‚ñ∂</button>
            </div>

            <div class="feedback-box" id="feedbackBox">
                <div class="feedback-header" id="feedbackHeader"></div>
                <div class="feedback-content" id="feedbackContent"></div>
                <div class="feedback-actions" id="feedbackActions">
                    <button class="btn btn-primary" id="btnContinue" onclick="App.continue()">Continuer ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Screen: Results -->
        <div class="screen" id="screenResults">
            <div class="results-box">
                <h2>üìä R√©sultats</h2>
                <p class="results-subtitle" id="resultsTitle"></p>
                <div class="score-grid">
                    <div class="score-card green"><div class="num" id="scoreIdeale">0</div><div class="label">‚úÖ Id√©ales</div></div>
                    <div class="score-card yellow"><div class="num" id="scoreAcceptable">0</div><div class="label">‚ö†Ô∏è Acceptables</div></div>
                    <div class="score-card red"><div class="num" id="scoreMauvaise">0</div><div class="label">‚ùå Reprises</div></div>
                </div>
                <div class="nclc-box"><div class="label">Estimation NCLC</div><div class="level" id="nclcLevel">7-8</div></div>
                <div class="tips-box"><h4>üí° Conseils</h4><ul id="tipsList"></ul></div>
                <div class="results-actions">
                    <button class="btn btn-secondary" onclick="App.restart()">Recommencer</button>
                    <button class="btn btn-primary" onclick="App.backToMenu()">Autre sc√©nario</button>
                </div>
            </div>
        </div>
    </div>

<script>
// ============================================================
// SCENARIO DATA
// ============================================================
const SCENARIOS = [
    {
        icon: 'üè†',
        title: 'Louer un appartement',
        context: `Vous avez vu une annonce sur le site d'une agence immobili√®re pour un appartement de trois pi√®ces situ√© dans le quartier du Plateau-Mont-Royal √† Montr√©al. Le loyer affich√© est de 1 450 $ par mois. Vous t√©l√©phonez √† l'agence pour obtenir plus de renseignements avant de prendre rendez-vous pour une visite.`,
        objective: `<strong>Votre objectif :</strong> Poser des questions pr√©cises et professionnelles pour obtenir toutes les informations n√©cessaires sur l'appartement.`,
        rounds: [
            {
                interviewer: `Agence Immobili√®re Dumoulin, bonjour. Je suis Nathalie, comment puis-je vous aider ?`,
                options: [
                    { text: `C'est pour un appartement.`, type: 'mauvaise' },
                    { text: `Bonjour, j'appelle pour une annonce que j'ai vue.`, type: 'mauvaise' },
                    { text: `Bonjour, j'ai vu une annonce pour un appartement sur le Plateau. Il est encore disponible ?`, type: 'acceptable' },
                    { text: `Bonjour Madame. Je vous appelle au sujet de l'appartement de trois pi√®ces situ√© rue Saint-Denis, dans le Plateau-Mont-Royal. Pourriez-vous me confirmer s'il est toujours disponible ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Euh, oui... c'est √† quel sujet ? Vous cherchez un appartement en particulier ?`,
                    acceptable: `Oui, c'est toujours disponible. C'est pour le T3 sur le Plateau, c'est √ßa ?`,
                    ideale: `Ah oui, le trois-pi√®ces rue Saint-Denis ! Oui, il est toujours disponible. Vous avez des questions sur l'appartement ?`
                },
                feedback: {
                    mauvaise: `Votre phrase ne pr√©cise pas de quel appartement il s'agit. L'interlocuteur doit demander des clarifications. √Ä NCLC 8, soyez pr√©cis d√®s le d√©part.`,
                    acceptable: `Compr√©hensible, mais une formulation plus compl√®te (adresse, type) serait plus professionnelle.`,
                    ideale: `Excellent ! Vous avez identifi√© l'appartement avec des d√©tails pr√©cis. Conversation efficace d√®s le d√©part.`
                }
            },
            {
                interviewer: `Oui, l'appartement est disponible √† partir du premier mars. Qu'est-ce que vous aimeriez savoir ?`,
                options: [
                    { text: `C'est cher ?`, type: 'mauvaise' },
                    { text: `Le loyer, c'est combien ?`, type: 'mauvaise' },
                    { text: `Pourriez-vous me confirmer le montant du loyer mensuel ?`, type: 'acceptable' },
                    { text: `Je voudrais savoir si le loyer de 1 450 $ inclut les charges, notamment le chauffage et l'√©lectricit√© ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Euh... le loyer ? C'est 1 450 $ comme indiqu√© sur l'annonce.`,
                    acceptable: `Le loyer est de 1 450 $ par mois. Les charges ne sont pas comprises.`,
                    ideale: `Le loyer est de 1 450 $ par mois, charges comprises ‚Äî √ßa inclut le chauffage et l'eau. L'√©lectricit√© est √† votre charge.`
                },
                feedback: {
                    mauvaise: `¬´ C'est cher ? ¬ª est trop vague et informel. Le prix est dans l'annonce. Demandez plut√¥t des d√©tails sur les charges.`,
                    acceptable: `Bonne question, mais anticipez en demandant directement si les charges sont incluses.`,
                    ideale: `Parfait ! Vous avez anticip√© un d√©tail important (les charges). C'est le niveau NCLC 8.`
                }
            },
            {
                interviewer: `C'est un appartement lumineux avec de grandes fen√™tres. Il y a un salon, deux chambres, une cuisine √©quip√©e et une salle de bain.`,
                options: [
                    { text: `C'est grand comment ?`, type: 'mauvaise' },
                    { text: `Il y a combien de pi√®ces ?`, type: 'mauvaise' },
                    { text: `Quelle est la superficie de l'appartement ?`, type: 'acceptable' },
                    { text: `Pourriez-vous me donner la superficie totale ainsi que l'√©tage ? Y a-t-il un ascenseur ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Euh, c'est grand, oui. Environ 75 m√®tres carr√©s, je crois.`,
                    acceptable: `L'appartement fait 75 m√®tres carr√©s. C'est au troisi√®me √©tage.`,
                    ideale: `L'appartement fait 78 m√®tres carr√©s. Il est au troisi√®me √©tage avec ascenseur. Le salon fait 25 m¬≤ et les chambres 12 et 14 m¬≤.`
                },
                feedback: {
                    mauvaise: `Trop vague. Demandez la superficie exacte ou des d√©tails pr√©cis.`,
                    acceptable: `Bonne question. Vous pourriez aussi demander l'√©tage ou l'ascenseur.`,
                    ideale: `Excellent ! Question compl√®te couvrant plusieurs aspects importants.`
                }
            },
            {
                interviewer: `Pour les conditions, nous demandons un d√©p√¥t de garantie d'un mois et des r√©f√©rences de votre ancien propri√©taire.`,
                options: [
                    { text: `Il faut quoi comme papiers ?`, type: 'mauvaise' },
                    { text: `C'est quoi les conditions ?`, type: 'mauvaise' },
                    { text: `Quels documents dois-je fournir pour le dossier ?`, type: 'acceptable' },
                    { text: `Pourriez-vous me d√©tailler les pi√®ces justificatives √† fournir ? Y a-t-il des exigences sur les revenus ou les garanties ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Il faut des papiers, oui. Pi√®ce d'identit√©, fiches de paie...`,
                    acceptable: `Nous demandons une pi√®ce d'identit√©, trois fiches de paie et une lettre de r√©f√©rence.`,
                    ideale: `Nous avons besoin d'une pi√®ce d'identit√©, trois fiches de paie, preuve d'emploi et lettre de r√©f√©rence. Le d√©p√¥t est encaiss√© √† la signature.`
                },
                feedback: {
                    mauvaise: `Trop informel. Utilisez un registre soutenu et soyez plus pr√©cis.`,
                    acceptable: `Bonne question. Demandez aussi les conditions sp√©cifiques.`,
                    ideale: `Parfait ! Question compl√®te et professionnelle.`
                }
            },
            {
                interviewer: `Nous organisons des visites du mardi au samedi. J'ai des disponibilit√©s jeudi apr√®s-midi et samedi matin.`,
                options: [
                    { text: `Je peux venir quand ?`, type: 'mauvaise' },
                    { text: `C'est possible de visiter ?`, type: 'mauvaise' },
                    { text: `Quels cr√©neaux avez-vous pour une visite ?`, type: 'acceptable' },
                    { text: `Serait-il possible de planifier une visite ? Je suis disponible jeudi apr√®s-midi ou samedi matin. Quel cr√©neau vous conviendrait ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Euh, vous voulez venir quand exactement ?`,
                    acceptable: `Jeudi, je peux proposer 14h ou 16h. Samedi, 10h ou 11h30.`,
                    ideale: `Parfait ! Jeudi j'ai 14h, 15h30 et 16h. Samedi, 10h ou 11h30. La visite dure 20 minutes. Qu'est-ce qui vous arrange ?`
                },
                feedback: {
                    mauvaise: `Trop direct et manque de politesse. Proposez vos disponibilit√©s.`,
                    acceptable: `Bonne d√©marche. Soyez plus pr√©cis en proposant vos propres cr√©neaux.`,
                    ideale: `Excellent ! Vous proposez des cr√©neaux pr√©cis tout en restant flexible.`
                }
            },
            {
                interviewer: `Parfait, je vous note pour samedi √† 10h. L'adresse est le 4521, rue Saint-Denis. Autre chose ?`,
                options: [
                    { text: `Non c'est bon.`, type: 'mauvaise' },
                    { text: `OK, √† samedi.`, type: 'mauvaise' },
                    { text: `Non, merci beaucoup. √Ä samedi.`, type: 'acceptable' },
                    { text: `Non, je pense avoir toutes les informations. Je vous remercie pour votre disponibilit√©. Je serai au 4521, rue Saint-Denis samedi √† 10h. Bonne journ√©e !`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `D'accord. Au revoir.`,
                    acceptable: `Tr√®s bien. √Ä samedi alors. Au revoir.`,
                    ideale: `Parfait ! √Ä samedi 10h. Au plaisir de vous rencontrer. Bonne journ√©e !`
                },
                feedback: {
                    mauvaise: `Trop bref. Confirmez les d√©tails et remerciez.`,
                    acceptable: `Bien. R√©capituler les informations serait encore mieux.`,
                    ideale: `Parfait ! R√©capitulatif professionnel et courtois.`
                }
            }
        ]
    },
    {
        icon: 'üõçÔ∏è',
        title: 'Retourner un produit',
        context: `Vous avez achet√© un ordinateur portable en ligne il y a deux semaines. L'√©cran affiche des lignes horizontales et l'appareil surchauffe. Vous contactez le service client pour un √©change ou remboursement.`,
        objective: `<strong>Votre objectif :</strong> Expliquer le probl√®me et obtenir une solution (√©change ou remboursement).`,
        rounds: [
            {
                interviewer: `TechnoPlus, service client, bonjour. Je suis Marc. Comment puis-je vous aider ?`,
                options: [
                    { text: `Mon ordi marche plus.`, type: 'mauvaise' },
                    { text: `J'ai un probl√®me avec un achat.`, type: 'mauvaise' },
                    { text: `Bonjour, j'ai achet√© un ordinateur et il ne fonctionne plus correctement.`, type: 'acceptable' },
                    { text: `Bonjour Marc. Je vous contacte au sujet d'un ordinateur achet√© il y a deux semaines. L'√©cran pr√©sente des lignes et l'appareil surchauffe. J'aimerais proc√©der √† un √©change ou remboursement.`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Euh... c'est quoi comme appareil exactement ?`,
                    acceptable: `D'accord. C'est un ordinateur portable ? Vous l'avez achet√© quand ?`,
                    ideale: `Je suis d√©sol√© pour ce d√©sagr√©ment. Puis-je avoir votre num√©ro de commande pour acc√©der √† votre dossier ?`
                },
                feedback: {
                    mauvaise: `Trop vague. Pr√©cisez le produit et le probl√®me exact.`,
                    acceptable: `Vous avez mentionn√© le produit. Ajoutez la date d'achat et le probl√®me pr√©cis.`,
                    ideale: `Excellent ! Tous les √©l√©ments essentiels sont pr√©sents pour un traitement rapide.`
                }
            },
            {
                interviewer: `Je vois votre commande. L'ordinateur est sous garantie. Pouvez-vous d√©crire les probl√®mes ?`,
                options: [
                    { text: `Ben, √ßa marche pas bien.`, type: 'mauvaise' },
                    { text: `L'√©cran a des probl√®mes.`, type: 'mauvaise' },
                    { text: `L'√©cran affiche des lignes horizontales depuis hier et il chauffe beaucoup.`, type: 'acceptable' },
                    { text: `Des lignes horizontales vertes et roses apparaissent sur l'√©cran depuis hier. L'appareil chauffe excessivement apr√®s dix minutes, le ventilateur tourne √† pleine vitesse. Je n'ai install√© aucun logiciel inhabituel.`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Des lignes ? Comment √ßa exactement ?`,
                    acceptable: `D'accord, ce probl√®me est apparu soudainement ?`,
                    ideale: `Ces sympt√¥mes indiquent un probl√®me mat√©riel. Vu la garantie, nous proposons un √©change ou remboursement. Quelle option pr√©f√©rez-vous ?`
                },
                feedback: {
                    mauvaise: `¬´ √áa marche pas ¬ª est trop vague. D√©crivez les sympt√¥mes pr√©cis.`,
                    acceptable: `Bonne description. Ajoutez des d√©tails sur les circonstances.`,
                    ideale: `Parfait ! Description pr√©cise et chronologique.`
                }
            },
            {
                interviewer: `Je vous propose un √©change ou un remboursement. Il faudra nous retourner l'appareil.`,
                options: [
                    { text: `Je sais pas, c'est quoi le mieux ?`, type: 'mauvaise' },
                    { text: `Je veux un √©change.`, type: 'mauvaise' },
                    { text: `Je pr√©f√©rerais un √©change. Comment se passe le retour ?`, type: 'acceptable' },
                    { text: `Je pr√©f√©rerais un √©change. Pourriez-vous m'expliquer la proc√©dure ? Combien de temps pour recevoir le nouvel appareil et dois-je renvoyer l'ancien en premier ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Qu'est-ce que vous pr√©f√©rez ?`,
                    acceptable: `Pour l'√©change, comptez 3 √† 5 jours apr√®s r√©ception du retour.`,
                    ideale: `Nous pouvons envoyer le nouvel appareil sous 48h et vous aurez 14 jours pour retourner l'ancien. Le remboursement prend 5-7 jours apr√®s r√©ception.`
                },
                feedback: {
                    mauvaise: `Indiquez clairement votre pr√©f√©rence.`,
                    acceptable: `Vous avez indiqu√© votre choix. Demandez les d√©tails de proc√©dure.`,
                    ideale: `Excellent ! Pr√©f√©rence claire et questions pratiques importantes.`
                }
            },
            {
                interviewer: `Vous pouvez d√©poser le colis en point relais ou nous organisons un enl√®vement √† domicile. Frais √† notre charge.`,
                options: [
                    { text: `C'est o√π ?`, type: 'mauvaise' },
                    { text: `Comment je fais ?`, type: 'mauvaise' },
                    { text: `Pourriez-vous me donner l'adresse du point relais le plus proche ?`, type: 'acceptable' },
                    { text: `Je pr√©f√©rerais un enl√®vement √† domicile. Quels cr√©neaux proposez-vous ? Et comment pr√©parer le colis ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `O√π √ßa un point relais ?`,
                    acceptable: `Il y a un point relais √† moins d'un km. Je peux vous envoyer l'adresse.`,
                    ideale: `Pour l'enl√®vement, je peux programmer demain entre 9h-12h ou 14h-17h. Gardez l'emballage d'origine si possible.`
                },
                feedback: {
                    mauvaise: `Trop vague. Demandez des pr√©cisions sur les options.`,
                    acceptable: `Bonne question. Demandez aussi les horaires ou pr√©paration.`,
                    ideale: `Parfait ! Questions pratiques pr√©cises.`
                }
            },
            {
                interviewer: `Enl√®vement programm√© pour demain entre 9h et 12h. Vous recevrez un SMS de confirmation.`,
                options: [
                    { text: `OK.`, type: 'mauvaise' },
                    { text: `Je vais recevoir une confirmation ?`, type: 'mauvaise' },
                    { text: `Pourriez-vous m'envoyer une confirmation par courriel ?`, type: 'acceptable' },
                    { text: `Parfait. Pourriez-vous m'envoyer un r√©capitulatif avec le num√©ro de dossier et les informations de suivi ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Oui, vous recevrez un SMS.`,
                    acceptable: `Oui, vous recevrez un courriel avec le num√©ro de suivi.`,
                    ideale: `Je vous envoie un courriel avec num√©ro de dossier, d√©tails d'enl√®vement et suivi. Vous pourrez suivre l'avancement sur notre site.`
                },
                feedback: {
                    mauvaise: `R√©ponse trop basique. Demandez un num√©ro de suivi.`,
                    acceptable: `Bonne question. Demandez aussi un num√©ro de r√©f√©rence.`,
                    ideale: `Excellent ! Confirmation √©crite et num√©ro de suivi demand√©s.`
                }
            },
            {
                interviewer: `Tout est enregistr√©. Vous recevrez la confirmation dans quelques minutes. Autre chose ?`,
                options: [
                    { text: `Non. Salut.`, type: 'mauvaise' },
                    { text: `C'est bon, merci.`, type: 'mauvaise' },
                    { text: `Non, c'est parfait. Merci beaucoup. Bonne journ√©e.`, type: 'acceptable' },
                    { text: `Non, tout est clair. Merci pour votre professionnalisme. J'attends l'enl√®vement demain et le nouvel appareil sous 48h. Excellente journ√©e !`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Au revoir.`,
                    acceptable: `De rien. Bonne journ√©e, au revoir.`,
                    ideale: `Merci √† vous. Tout sera r√©gl√© rapidement. Excellente journ√©e !`
                },
                feedback: {
                    mauvaise: `Trop abrupt. Remerciez votre interlocuteur.`,
                    acceptable: `Bien. R√©capituler serait encore mieux.`,
                    ideale: `Parfait ! Conclusion professionnelle avec r√©capitulatif.`
                }
            }
        ]
    },
    {
        icon: 'üíº',
        title: "Se renseigner sur une offre d'emploi",
        context: `Vous avez vu une offre pour un poste de charg√© de communication chez √âcoTech Solutions. CDI, ¬´ salaire selon exp√©rience ¬ª. Vous appelez pour en savoir plus.`,
        objective: `<strong>Votre objectif :</strong> Obtenir des informations sur le poste, les conditions et le processus de recrutement.`,
        rounds: [
            {
                interviewer: `√âcoTech Solutions, bonjour. Ressources humaines, Sophie √† l'appareil.`,
                options: [
                    { text: `C'est pour un emploi.`, type: 'mauvaise' },
                    { text: `Bonjour, vous avez des postes ?`, type: 'mauvaise' },
                    { text: `Bonjour, j'appelle pour le poste de charg√© de communication. Il est toujours disponible ?`, type: 'acceptable' },
                    { text: `Bonjour Sophie. Je me permets de vous appeler au sujet de l'offre de charg√© de communication. J'aurais quelques questions avant de soumettre ma candidature. Le poste est-il toujours ouvert ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Pour quel poste exactement ?`,
                    acceptable: `Oui, le poste est encore ouvert. Vous avez des questions ?`,
                    ideale: `Bonjour ! Oui, le poste est √† pourvoir. La date limite est le 15 du mois prochain. Que souhaitez-vous savoir ?`
                },
                feedback: {
                    mauvaise: `Trop vague. Identifiez clairement le poste.`,
                    acceptable: `Poste identifi√©, mais formulation plus professionnelle possible.`,
                    ideale: `Excellent ! Demande professionnelle et pr√©cise.`
                }
            },
            {
                interviewer: `Le poste est rattach√© au marketing. Vous g√©rerez la communication externe avec une √©quipe de cinq personnes.`,
                options: [
                    { text: `Je ferais quoi exactement ?`, type: 'mauvaise' },
                    { text: `C'est quoi le travail ?`, type: 'mauvaise' },
                    { text: `Pourriez-vous me d√©tailler les missions principales ?`, type: 'acceptable' },
                    { text: `Pourriez-vous me pr√©senter les missions principales et les projets concrets ? Y a-t-il des responsabilit√©s particuli√®res ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Vous faites de la communication externe...`,
                    acceptable: `Les missions incluent communiqu√©s de presse, r√©seaux sociaux et √©v√©nements.`,
                    ideale: `Vous serez en charge de la strat√©gie digitale, communiqu√©s de presse, r√©seaux sociaux et relations m√©dias. Vous organiserez aussi notre salon annuel de l'environnement.`
                },
                feedback: {
                    mauvaise: `Trop informel. Demandez les missions de mani√®re professionnelle.`,
                    acceptable: `Bonne question. Demandez aussi les responsabilit√©s sp√©cifiques.`,
                    ideale: `Parfait ! Question compl√®te sur missions et projets.`
                }
            },
            {
                interviewer: `Nous cherchons trois ans d'exp√©rience minimum, excellente ma√Ætrise du fran√ßais √©crit et capacit√© √† g√©rer plusieurs projets.`,
                options: [
                    { text: `C'est tout ?`, type: 'mauvaise' },
                    { text: `Il faut quoi comme dipl√¥me ?`, type: 'mauvaise' },
                    { text: `Y a-t-il des comp√©tences techniques requises, comme certains logiciels ?`, type: 'acceptable' },
                    { text: `En dehors de l'exp√©rience, y a-t-il des comp√©tences techniques attendues ? Outils num√©riques, comp√©tences r√©dactionnelles ou langues √©trang√®res ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Pas d'autres comp√©tences particuli√®res...`,
                    acceptable: `La ma√Ætrise d'Adobe serait un plus. L'anglais aussi.`,
                    ideale: `Nous appr√©cions la suite Adobe, le SEO et une sensibilit√© environnementale. L'anglais professionnel est un atout pour nos partenaires internationaux.`
                },
                feedback: {
                    mauvaise: `Question mal structur√©e. Demandez des comp√©tences sp√©cifiques.`,
                    acceptable: `Bonne question. Approfondissez sur les langues ou certifications.`,
                    ideale: `Excellent ! Question strat√©gique pour votre candidature.`
                }
            },
            {
                interviewer: `Le salaire est entre 45 000 et 55 000 $ selon l'exp√©rience, avec plusieurs avantages sociaux.`,
                options: [
                    { text: `C'est tout ?`, type: 'mauvaise' },
                    { text: `C'est n√©gociable ?`, type: 'mauvaise' },
                    { text: `Pourriez-vous pr√©ciser les avantages sociaux ?`, type: 'acceptable' },
                    { text: `Merci pour ces pr√©cisions. Pourriez-vous d√©tailler les avantages sociaux ? Assurance, retraite, t√©l√©travail ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Il y a des avantages, oui...`,
                    acceptable: `Assurance collective, trois semaines de vacances et deux jours de t√©l√©travail.`,
                    ideale: `Assurance compl√®te sant√© et dentaire, r√©gime de retraite avec contribution employeur, quatre semaines de vacances, t√©l√©travail deux jours par semaine, et budget formation annuel.`
                },
                feedback: {
                    mauvaise: `√âvitez les jugements. Demandez les d√©tails des avantages.`,
                    acceptable: `Bonne question. Demandez aussi les conditions de travail.`,
                    ideale: `Parfait ! Question compl√®te pour √©valuer l'offre globale.`
                }
            },
            {
                interviewer: `Le processus comprend s√©lection sur CV, entretien avec le responsable marketing, puis rencontre avec la DRH.`,
                options: [
                    { text: `C'est long ?`, type: 'mauvaise' },
                    { text: `C'est quand les entretiens ?`, type: 'mauvaise' },
                    { text: `Quel est le calendrier pr√©vu pour le recrutement ?`, type: 'acceptable' },
                    { text: `Pourriez-vous pr√©ciser le calendrier ? Quand les entretiens sont-ils pr√©vus et quelle est la date d'entr√©e en poste envisag√©e ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `√áa prend quelques semaines...`,
                    acceptable: `Le processus prend deux √† trois semaines. D√©cision fin janvier.`,
                    ideale: `Environ trois semaines. R√©ponse sous huit jours si retenu. Premier entretien en visio, 45 minutes. Second en pr√©sentiel avec mise en situation. D√©but de contrat pr√©vu en f√©vrier.`
                },
                feedback: {
                    mauvaise: `Trop vague. Demandez les √©tapes et dates pr√©cises.`,
                    acceptable: `Bonne question. Demandez aussi le format des entretiens.`,
                    ideale: `Excellent ! Question strat√©gique pour planifier votre candidature.`
                }
            },
            {
                interviewer: `Envoyez votre CV et lettre √† recrutement@ecotech.ca. D'autres questions ?`,
                options: [
                    { text: `OK, au revoir.`, type: 'mauvaise' },
                    { text: `D'accord, j'envoie mon CV.`, type: 'mauvaise' },
                    { text: `Merci beaucoup. Je vous envoie ma candidature prochainement. Bonne journ√©e.`, type: 'acceptable' },
                    { text: `Merci infiniment pour ces pr√©cisions, Sophie. Le poste correspond exactement √† mes attentes. J'envoie mon dossier dans les meilleurs d√©lais. Excellente journ√©e !`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Au revoir.`,
                    acceptable: `Tr√®s bien, nous attendons votre candidature. Bonne journ√©e.`,
                    ideale: `Merci pour votre int√©r√™t ! Nous attendons votre candidature avec plaisir. Excellente journ√©e !`
                },
                feedback: {
                    mauvaise: `Trop abrupt. Remerciez et confirmez votre int√©r√™t.`,
                    acceptable: `Bien. Montrez votre enthousiasme pour le poste.`,
                    ideale: `Parfait ! Conclusion professionnelle et motiv√©e.`
                }
            }
        ]
    },
    {
        icon: 'üè®',
        title: 'Modifier une r√©servation',
        context: `Vous avez r√©serv√© une chambre d'h√¥tel √† Qu√©bec du 15 au 17 mars. Suite √† un changement d'emploi du temps, vous devez modifier les dates.`,
        objective: `<strong>Votre objectif :</strong> Modifier vos dates, v√©rifier les disponibilit√©s et les √©ventuels frais.`,
        rounds: [
            {
                interviewer: `H√¥tel Le Ch√¢teau Frontenac, service r√©servations. Bonsoir, Philippe √† votre service.`,
                options: [
                    { text: `Je veux changer ma r√©servation.`, type: 'mauvaise' },
                    { text: `Bonsoir, j'ai r√©serv√© une chambre et je dois modifier.`, type: 'mauvaise' },
                    { text: `Bonsoir, j'ai une r√©servation pour les 15 et 16 mars. J'aimerais la modifier.`, type: 'acceptable' },
                    { text: `Bonsoir Philippe. J'ai une r√©servation au nom de Tremblay pour les nuits du 15 et 16 mars. Suite √† un impr√©vu professionnel, j'aurais besoin de modifier les dates. Est-ce possible ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Vous avez une r√©servation √† quel nom ?`,
                    acceptable: `D'accord. √Ä quel nom est la r√©servation ?`,
                    ideale: `Je vois votre r√©servation. Chambre Sup√©rieure pour les 15 et 16 mars. Quelles nouvelles dates souhaiteriez-vous ?`
                },
                feedback: {
                    mauvaise: `Trop vague. Donnez votre nom ou num√©ro de r√©servation.`,
                    acceptable: `Demande identifi√©e. Fournir directement les d√©tails serait plus efficace.`,
                    ideale: `Excellent ! Tous les √©l√©ments pour retrouver la r√©servation.`
                }
            },
            {
                interviewer: `J'ai votre r√©servation. Chambre Sup√©rieure pour les 15 et 16 mars. Quelles nouvelles dates ?`,
                options: [
                    { text: `Plus tard dans le mois ?`, type: 'mauvaise' },
                    { text: `La semaine d'apr√®s ?`, type: 'mauvaise' },
                    { text: `J'aimerais d√©caler au 22 et 23 mars. C'est disponible ?`, type: 'acceptable' },
                    { text: `J'aurais besoin de reporter aux nuits du 22 et 23 mars. Auriez-vous des disponibilit√©s, id√©alement pour le m√™me type de chambre ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Plus tard quand exactement ?`,
                    acceptable: `Le 22 et 23, je v√©rifie... Oui, c'est disponible.`,
                    ideale: `Je v√©rifie. Oui, chambre Sup√©rieure disponible pour les 22 et 23 mars. Souhaitez-vous conserver ce type de chambre ?`
                },
                feedback: {
                    mauvaise: `¬´ Plus tard ¬ª est trop vague. Donnez des dates pr√©cises.`,
                    acceptable: `Dates donn√©es. Demandez aussi la disponibilit√© du m√™me type de chambre.`,
                    ideale: `Parfait ! Dates pr√©cises et question sur les disponibilit√©s.`
                }
            },
            {
                interviewer: `Le tarif pour ces dates est de 285 $ au lieu de 265 $ ‚Äî il y a un festival en ville ce week-end.`,
                options: [
                    { text: `C'est cher !`, type: 'mauvaise' },
                    { text: `Pourquoi c'est plus cher ?`, type: 'mauvaise' },
                    { text: `D'accord, je comprends. √áa me convient.`, type: 'acceptable' },
                    { text: `Je comprends pour la diff√©rence. Y aurait-il un geste commercial possible, comme un surclassement ou le petit-d√©jeuner inclus ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `C'est le tarif standard pour cette p√©riode...`,
                    acceptable: `Tr√®s bien. Je modifie la r√©servation.`,
                    ideale: `Je peux vous offrir le petit-d√©jeuner continental pour les deux matins, soit 80 $ de valeur. Cela vous conviendrait ?`
                },
                feedback: {
                    mauvaise: `√âvitez les commentaires n√©gatifs. Demandez des alternatives.`,
                    acceptable: `Acceptation correcte. N√©gocier un avantage serait plus strat√©gique.`,
                    ideale: `Excellent ! N√©gociation professionnelle et courtoise.`
                }
            },
            {
                interviewer: `Je peux vous offrir le petit-d√©jeuner continental pour les deux matins. √áa vous convient ?`,
                options: [
                    { text: `OK.`, type: 'mauvaise' },
                    { text: `D'accord pour le petit-d√©jeuner.`, type: 'mauvaise' },
                    { text: `Oui, c'est tr√®s bien. Le petit-d√©jeuner est servi √† quelle heure ?`, type: 'acceptable' },
                    { text: `Parfait, j'accepte avec plaisir. Pourriez-vous me pr√©ciser les horaires du petit-d√©jeuner et s'il est possible d'avoir une chambre avec vue ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Tr√®s bien.`,
                    acceptable: `Le petit-d√©jeuner est servi de 7h √† 10h au restaurant Le Champlain.`,
                    ideale: `Petit-d√©jeuner de 6h30 √† 10h30 au Champlain. Je note votre pr√©f√©rence pour une chambre avec vue ou en √©tage √©lev√©. Autre chose ?`
                },
                feedback: {
                    mauvaise: `Trop bref. Demandez des d√©tails pratiques.`,
                    acceptable: `Bonne question. Ajoutez une pr√©f√©rence sur la chambre.`,
                    ideale: `Parfait ! Confirmation et question pratique pertinente.`
                }
            },
            {
                interviewer: `Je note votre pr√©f√©rence. La modification n'entra√Æne pas de frais. Paiement √† l'arriv√©e ou maintenant ?`,
                options: [
                    { text: `√Ä l'arriv√©e.`, type: 'mauvaise' },
                    { text: `Je paye comment ?`, type: 'mauvaise' },
                    { text: `Je pr√©f√©rerais r√©gler √† l'arriv√©e. C'est possible ?`, type: 'acceptable' },
                    { text: `Je souhaiterais r√©gler √† l'arriv√©e. Une empreinte de carte est-elle n√©cessaire ? Et quels modes de paiement acceptez-vous ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `D'accord, √† l'arriv√©e.`,
                    acceptable: `Oui, paiement √† l'arriv√©e possible. Une empreinte de carte garantira la r√©servation.`,
                    ideale: `Paiement √† l'arriv√©e, aucun probl√®me. Empreinte de carte pour garantie, pr√©l√®vement au d√©part. Nous acceptons toutes les cartes. D'autres questions ?`
                },
                feedback: {
                    mauvaise: `R√©ponse trop directe. Demandez les modalit√©s.`,
                    acceptable: `Bon choix. Demandez si une garantie est requise.`,
                    ideale: `Excellent ! Modalit√©s de paiement clarifi√©es.`
                }
            },
            {
                interviewer: `Votre r√©servation est modifi√©e pour les 22 et 23 mars avec petit-d√©jeuner. Autre chose ?`,
                options: [
                    { text: `Non merci, au revoir.`, type: 'mauvaise' },
                    { text: `C'est tout, merci.`, type: 'mauvaise' },
                    { text: `Non, tout est en ordre. Merci beaucoup. Bonne soir√©e.`, type: 'acceptable' },
                    { text: `Non, tout est parfait. Je r√©capitule : chambre Sup√©rieure les 22 et 23 mars, petit-d√©jeuner inclus. Merci pour votre professionnalisme, Philippe. Bonne soir√©e !`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Au revoir.`,
                    acceptable: `De rien. Bonne soir√©e et √† bient√¥t.`,
                    ideale: `Merci √† vous ! Chambre avec vue not√©e. Au plaisir de vous accueillir. Excellente soir√©e !`
                },
                feedback: {
                    mauvaise: `Trop bref. R√©capitulez et remerciez.`,
                    acceptable: `Bien. Un r√©capitulatif serait id√©al.`,
                    ideale: `Parfait ! R√©capitulatif professionnel et courtois.`
                }
            }
        ]
    },
    {
        icon: 'üéæ',
        title: "S'inscrire √† un cours",
        context: `Vous voulez reprendre le sport et avez entendu parler des cours de tennis au Centre sportif du Parc. Vous t√©l√©phonez pour vous renseigner sur les cours adultes d√©butants.`,
        objective: `<strong>Votre objectif :</strong> Obtenir des informations sur les cours (horaires, tarifs, inscription).`,
        rounds: [
            {
                interviewer: `Centre sportif du Parc, bonjour. √âmilie √† l'accueil, comment puis-je vous aider ?`,
                options: [
                    { text: `Vous avez des cours de sport ?`, type: 'mauvaise' },
                    { text: `C'est pour des cours de tennis.`, type: 'mauvaise' },
                    { text: `Bonjour, j'aimerais me renseigner sur vos cours de tennis pour adultes.`, type: 'acceptable' },
                    { text: `Bonjour √âmilie. Je souhaiterais me renseigner sur vos cours de tennis pour adultes d√©butants. Pourriez-vous me pr√©senter les formules propos√©es ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Des cours de quoi exactement ?`,
                    acceptable: `Oui, nous avons des cours pour tous les niveaux. Vous √™tes d√©butant ?`,
                    ideale: `Bonjour ! Nous avons plusieurs formules pour d√©butants : cours collectifs et le√ßons particuli√®res. Qu'est-ce qui vous int√©resserait ?`
                },
                feedback: {
                    mauvaise: `Trop vague. Pr√©cisez l'activit√© et votre niveau.`,
                    acceptable: `Bonne introduction. Pr√©cisez votre niveau et le type de cours souhait√©.`,
                    ideale: `Excellent ! Demande claire et pr√©cise.`
                }
            },
            {
                interviewer: `Pour les cours collectifs d√©butants : mardi soir 19h-20h30 et samedi matin 10h-11h30. Groupes de six personnes maximum.`,
                options: [
                    { text: `√áa dure combien de temps ?`, type: 'mauvaise' },
                    { text: `Les cours, c'est comment ?`, type: 'mauvaise' },
                    { text: `Combien de cours dans une session et quand commence la prochaine ?`, type: 'acceptable' },
                    { text: `Pourriez-vous pr√©ciser le nombre de cours par session, les dates de d√©but et fin, et les places disponibles ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `√áa dure une heure et demie...`,
                    acceptable: `Une session comprend dix cours. La prochaine commence d√©but janvier.`,
                    ideale: `Sessions de dix semaines. Prochaine session du 8 janvier au 15 mars. Il reste des places sur les deux cr√©neaux.`
                },
                feedback: {
                    mauvaise: `Ambigu√´ ‚Äî chaque cours ou la session ? Soyez pr√©cis.`,
                    acceptable: `Bonne question. Demandez aussi les dates exactes et places disponibles.`,
                    ideale: `Parfait ! Question compl√®te sur le format et l'organisation.`
                }
            },
            {
                interviewer: `La session de dix cours est √† 180 $. Acc√®s aux courts et pr√™t de raquettes inclus. Cours particuliers √† 45 $ la s√©ance.`,
                options: [
                    { text: `C'est trop cher.`, type: 'mauvaise' },
                    { text: `Combien √ßa co√ªte ?`, type: 'mauvaise' },
                    { text: `Y a-t-il des tarifs r√©duits ou un paiement en plusieurs fois ?`, type: 'acceptable' },
                    { text: `Proposez-vous des tarifs r√©duits pour √©tudiants ou familles ? Et peut-on √©chelonner le paiement ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `C'est le tarif standard...`,
                    acceptable: `Tarif r√©duit de 150 $ pour √©tudiants et a√Æn√©s. Paiement en trois fois possible.`,
                    ideale: `150 $ pour √©tudiants et a√Æn√©s, tarif famille 320 $ pour deux personnes. Paiement en trois fois sans frais. Premier cours offert pour essayer !`
                },
                feedback: {
                    mauvaise: `√âvitez les commentaires n√©gatifs. Demandez les r√©ductions.`,
                    acceptable: `Bonne question. Demandez aussi les facilit√©s de paiement.`,
                    ideale: `Excellent ! R√©ductions et facilit√©s demand√©es professionnellement.`
                }
            },
            {
                interviewer: `Nous fournissons les balles et pr√™tons une raquette pour les d√©butants. Apportez des chaussures de sport propres.`,
                options: [
                    { text: `Je mets quoi comme habits ?`, type: 'mauvaise' },
                    { text: `Il faut acheter une raquette ?`, type: 'mauvaise' },
                    { text: `Quelle tenue recommandez-vous ?`, type: 'acceptable' },
                    { text: `Pourriez-vous pr√©ciser les exigences vestimentaires, notamment pour les chaussures ? Des recommandations pour le choix d'une raquette ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Des v√™tements de sport...`,
                    acceptable: `Tenue de sport confortable. Pour les chaussures, √©vitez les semelles noires.`,
                    ideale: `Tenue confortable. Chaussures de tennis √† semelles claires obligatoires sur nos courts. Notre boutique a des mod√®les √† partir de 60 $. Votre prof vous conseillera pour la raquette apr√®s quelques cours.`
                },
                feedback: {
                    mauvaise: `Question trop basique. Demandez des d√©tails sur les exigences.`,
                    acceptable: `Bonne question. Demandez des recommandations pr√©cises.`,
                    ideale: `Parfait ! Question pratique montrant votre pr√©paration.`
                }
            },
            {
                interviewer: `Inscription sur notre site internet ou √† l'accueil. Pi√®ce d'identit√© et paiement n√©cessaires.`,
                options: [
                    { text: `OK, je regarde.`, type: 'mauvaise' },
                    { text: `C'est quoi le site ?`, type: 'mauvaise' },
                    { text: `L'inscription en ligne est-elle rapide ? Quels documents ?`, type: 'acceptable' },
                    { text: `Je pr√©f√©rerais m'inscrire en ligne. Pourriez-vous confirmer l'adresse du site et les informations n√©cessaires ? Y a-t-il une confirmation par courriel ?`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Le site c'est centresportifduparc.ca.`,
                    acceptable: `L'inscription prend cinq minutes. Confirmation par courriel avec tous les d√©tails.`,
                    ideale: `Cr√©ez un compte sur centresportifduparc.ca, choisissez le cr√©neau et payez. Confirmation imm√©diate avec lieu, prof et mat√©riel recommand√©. Accueil ouvert lundi-samedi 9h-20h.`
                },
                feedback: {
                    mauvaise: `R√©ponse vague. Demandez les d√©tails de l'inscription.`,
                    acceptable: `Bonne question. Demandez aussi les horaires d'accueil.`,
                    ideale: `Excellent ! D√©tails pratiques pour faciliter l'inscription.`
                }
            },
            {
                interviewer: `Notre site est centresportifduparc.ca. D'autres questions ?`,
                options: [
                    { text: `Non, merci. Salut.`, type: 'mauvaise' },
                    { text: `Non, √ßa va.`, type: 'mauvaise' },
                    { text: `Non, c'est parfait. Merci, je vais m'inscrire. Bonne journ√©e !`, type: 'acceptable' },
                    { text: `Non, tout est clair. Session de dix cours le samedi √† partir du 8 janvier pour 180 $. Je m'inscris sur centresportifduparc.ca. Merci beaucoup √âmilie ! J'ai h√¢te de commencer !`, type: 'ideale' },
                ],
                responses: {
                    mauvaise: `Au revoir.`,
                    acceptable: `Tr√®s bien, bonne inscription ! √Ä bient√¥t.`,
                    ideale: `Parfait ! Nous avons h√¢te de vous accueillir. Excellente journ√©e et √† bient√¥t sur les courts !`
                },
                feedback: {
                    mauvaise: `Trop bref. R√©capitulez et remerciez.`,
                    acceptable: `Bien. Un r√©capitulatif montrerait votre attention.`,
                    ideale: `Parfait ! R√©capitulatif complet et enthousiasme appropri√©.`
                }
            }
        ]
    }
];

// ============================================================
// APPLICATION STATE
// ============================================================
const App = {
    // State
    voiceEnabled: false,
    apiKey: null,
    scenario: null,
    round: 0,
    selected: null,
    lastType: null,
    scores: { ideale: 0, acceptable: 0, mauvaise: 0 },

    // --------------------------------------------------------
    // INITIALIZATION
    // --------------------------------------------------------
    init() {
        this.renderScenarioList();
        const savedKey = sessionStorage.getItem('xi_key');
        if (savedKey) {
            document.getElementById('apiKey').value = savedKey;
            this.apiKey = savedKey;
            this.voiceEnabled = true;
            document.getElementById('apiStatus').textContent = 'üîä Voix activ√©e';
            document.getElementById('apiStatus').classList.add('active');
        }
    },

    renderScenarioList() {
        const container = document.getElementById('scenarioList');
        container.innerHTML = SCENARIOS.map((s, i) => `
            <div class="scenario-card" onclick="App.selectScenario(${i})">
                <div class="scenario-icon">${s.icon}</div>
                <div class="scenario-info">
                    <h3>${s.title}</h3>
                    <p>${s.context.substring(0, 100)}...</p>
                </div>
            </div>
        `).join('');
    },

    // --------------------------------------------------------
    // VOICE
    // --------------------------------------------------------
    async activateVoice() {
        const key = document.getElementById('apiKey').value.trim();
        if (!key) return alert('Entrez une cl√© API.');

        try {
            const res = await fetch('https://api.elevenlabs.io/v1/user', {
                headers: { 'xi-api-key': key }
            });
            if (res.ok) {
                this.apiKey = key;
                this.voiceEnabled = true;
                sessionStorage.setItem('xi_key', key);
                document.getElementById('apiStatus').textContent = 'üîä Voix activ√©e';
                document.getElementById('apiStatus').classList.add('active');
            } else {
                alert('Cl√© invalide. V√©rifiez et r√©essayez.');
            }
        } catch (e) {
            alert('Erreur de connexion.');
        }
    },

    async playAudio() {
        if (!this.voiceEnabled || !this.apiKey) return;
        const text = this.scenario.rounds[this.round].interviewer;
        this.speak(text);
    },

    async speak(text) {
        if (!this.voiceEnabled || !this.apiKey) return;
        try {
            const res = await fetch('https://api.elevenlabs.io/v1/text-to-speech/XTyroWkQl32ZSd3rRVZ1', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'xi-api-key': this.apiKey },
                body: JSON.stringify({
                    text,
                    model_id: 'eleven_multilingual_v2',
                    voice_settings: { stability: 0.5, similarity_boost: 0.75 }
                })
            });
            if (res.ok) {
                const blob = await res.blob();
                const audio = new Audio(URL.createObjectURL(blob));
                audio.play();
            }
        } catch (e) {
            console.log('Audio error:', e);
        }
    },

    // --------------------------------------------------------
    // NAVIGATION
    // --------------------------------------------------------
    showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    },

    selectScenario(index) {
        this.scenario = SCENARIOS[index];
        this.round = 0;
        this.scores = { ideale: 0, acceptable: 0, mauvaise: 0 };
        this.selected = null;
        this.lastType = null;

        document.getElementById('ctxTitle').innerHTML = `${this.scenario.icon} ${this.scenario.title}`;
        document.getElementById('ctxText').textContent = this.scenario.context;
        document.getElementById('ctxObjective').innerHTML = this.scenario.objective;

        this.showScreen('screenContext');
    },

    startDialogue() {
        this.showScreen('screenDialogue');
        this.renderRound();
    },

    backToMenu() {
        this.showScreen('screenSelect');
    },

    restart() {
        this.round = 0;
        this.scores = { ideale: 0, acceptable: 0, mauvaise: 0 };
        this.selected = null;
        this.lastType = null;
        this.showScreen('screenDialogue');
        this.renderRound();
    },

    // --------------------------------------------------------
    // DIALOGUE LOGIC
    // --------------------------------------------------------
    renderRound() {
        const r = this.scenario.rounds[this.round];
        this.selected = null;
        this.lastType = null;

        // Progress bar
        const total = this.scenario.rounds.length;
        document.getElementById('progressBar').innerHTML = 
            this.scenario.rounds.map((_, i) => 
                `<div class="progress-step ${i < this.round ? 'done' : ''} ${i === this.round ? 'current' : ''}"></div>`
            ).join('') + `<span class="progress-text">${this.round + 1}/${total}</span>`;

        // Interviewer
        document.getElementById('interviewerText').textContent = `¬´ ${r.interviewer} ¬ª`;

        // Questions (shuffled)
        const shuffled = [...r.options].sort(() => Math.random() - 0.5);
        document.getElementById('questionList').innerHTML = shuffled.map((opt, i) => `
            <div class="question-item" data-type="${opt.type}" data-index="${i}" onclick="App.selectOption(this)">
                <div class="question-radio"></div>
                <div class="question-content">¬´ ${opt.text} ¬ª</div>
            </div>
        `).join('');

        // Reset UI
        document.getElementById('btnValidate').disabled = true;
        document.getElementById('feedbackBox').classList.remove('visible', 'mauvaise', 'acceptable', 'ideale');
        document.getElementById('questionsSection').style.display = 'block';
        document.getElementById('validateRow').style.display = 'flex';

        // Auto-play
        if (this.voiceEnabled) {
            setTimeout(() => this.playAudio(), 400);
        }

        window.scrollTo({ top: 0, behavior: 'smooth' });
    },

    selectOption(el) {
        document.querySelectorAll('.question-item').forEach(q => q.classList.remove('selected'));
        el.classList.add('selected');
        this.selected = el.dataset.type;
        document.getElementById('btnValidate').disabled = false;
    },

    validate() {
        if (!this.selected) return;

        const type = this.selected;
        this.lastType = type;
        this.scores[type]++;

        const r = this.scenario.rounds[this.round];
        const response = r.responses[type];
        const feedback = r.feedback[type];

        // Header
        const icons = { mauvaise: '‚ùå', acceptable: '‚ö†Ô∏è', ideale: '‚úÖ' };
        const titles = { mauvaise: 'Question inappropri√©e', acceptable: 'Correct, mais basique', ideale: 'Excellent !' };
        document.getElementById('feedbackHeader').innerHTML = `${icons[type]} ${titles[type]}`;

        // Content
        document.getElementById('feedbackContent').innerHTML = `
            <p><strong>L'interlocuteur r√©pond :</strong></p>
            <p style="font-style:italic; margin: 0.5rem 0;">¬´ ${response} ¬ª</p>
            <p>${feedback}</p>
        `;

        // Button text
        const btn = document.getElementById('btnContinue');
        if (type === 'mauvaise') {
            btn.textContent = 'Essayer encore ‚Üí';
        } else if (this.round < this.scenario.rounds.length - 1) {
            btn.textContent = 'Continuer ‚Üí';
        } else {
            btn.textContent = 'Voir les r√©sultats ‚Üí';
        }

        // Show feedback
        document.getElementById('feedbackBox').className = `feedback-box visible ${type}`;

        // Hide questions
        document.getElementById('questionsSection').style.display = 'none';
        document.getElementById('validateRow').style.display = 'none';

        // Play response audio
        if (this.voiceEnabled) {
            setTimeout(() => this.speak(response), 300);
        }
    },

    continue() {
        if (this.lastType === 'mauvaise') {
            // Retry same round
            this.renderRound();
        } else if (this.round < this.scenario.rounds.length - 1) {
            // Next round
            this.round++;
            this.renderRound();
        } else {
            // Show results
            this.showResults();
        }
    },

    // --------------------------------------------------------
    // RESULTS
    // --------------------------------------------------------
    showResults() {
        document.getElementById('resultsTitle').textContent = this.scenario.title;
        document.getElementById('scoreIdeale').textContent = this.scores.ideale;
        document.getElementById('scoreAcceptable').textContent = this.scores.acceptable;
        document.getElementById('scoreMauvaise').textContent = this.scores.mauvaise;

        // NCLC estimate
        const total = this.scores.ideale + this.scores.acceptable;
        const ratio = total > 0 ? this.scores.ideale / total : 0;
        let level = '5-6';
        if (ratio >= 0.8 && this.scores.mauvaise === 0) level = '8-9';
        else if (ratio >= 0.6) level = '7-8';
        else if (ratio >= 0.4) level = '6-7';
        document.getElementById('nclcLevel').textContent = level;

        // Tips
        const tips = [];
        if (this.scores.mauvaise > 0) tips.push('√âvitez les formulations vagues ou trop informelles.');
        if (this.scores.acceptable > this.scores.ideale) tips.push('Anticipez les d√©tails importants dans vos questions.');
        if (this.scores.ideale >= 3) tips.push('Excellent travail sur la pr√©cision et le registre formel !');
        tips.push('Continuez √† pratiquer pour automatiser les formulations NCLC 8.');
        document.getElementById('tipsList').innerHTML = tips.map(t => `<li>${t}</li>`).join('');

        this.showScreen('screenResults');
    }
};

// Initialize on load
document.addEventListener('DOMContentLoaded', () => App.init());
</script>
</body>
</html>
